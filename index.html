<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SunWin Tài Xỉu</title>
<style>
  :root {
    --bg1: #1f2833;
    --bg2: #0b0c10;
    --accent: #f39c12;
    --light: #c5c6c7;
  }
  * { box-sizing: border-box; margin:0; padding:0; }
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, var(--bg1), var(--bg2));
    color: #fff;
    text-align: center;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }
  .logo {
    margin-top: 10px;
  }
  .logo img {
    width: 120px;
    border-radius: 8px;
    box-shadow: 0 6px 14px rgba(0,0,0,0.5);
  }
  .banner {
    font-size: 32px;
    margin: 10px 0;
    color: gold;
    font-weight: bold;
    text-shadow: 0 3px 10px rgba(0,0,0,0.7);
  }
  .card {
    background: rgba(255,255,255,0.08);
    border-radius: 12px;
    padding: 15px;
    margin: 10px 0;
    width: 100%;
    max-width: 400px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.5);
  }
  input, select, button {
    padding: 8px;
    margin: 6px;
    border: none;
    border-radius: 6px;
    font-size: 16px;
  }
  button {
    background: var(--accent);
    color: #fff;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:disabled {
    background: #555;
    cursor: not-allowed;
  }
  .plate {
    margin: 20px auto;
    width: 200px;
    height: 200px;
    border-radius: 50%;
    position: relative;
    background: radial-gradient(circle at center, #4b2020, #1c0606);
    box-shadow: inset 0 0 30px rgba(0,0,0,0.7), 0 8px 20px rgba(0,0,0,0.5);
  }
  .cover {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: radial-gradient(circle at center, #999, #333);
    z-index: 3;
    transition: transform 1s ease-in-out;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 18px rgba(0,0,0,0.6);
  }
  .cover.open {
    transform: translateY(-250px);
  }
  .dice-area {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%);
    display: flex;
    gap: 6px;
    z-index: 2;
  }
  .dice {
    width: 56px;
    height: 56px;
    border-radius: 8px;
    background: #fff;
    color: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  }
  .shake {
    animation: shake 0.6s infinite;
  }
  @keyframes shake {
    0% { transform: translate(0,0) rotate(0deg); }
    25% { transform: translate(-3px,2px) rotate(-2deg); }
    50% { transform: translate(3px,-2px) rotate(2deg); }
    75% { transform: translate(-2px,1px) rotate(-1deg); }
    100% { transform: translate(0,0) rotate(0deg); }
  }
  #result {
    margin-top: 12px;
    min-height: 40px;
    font-size: 18px;
    color: var(--light);
  }
  .footer {
    margin-top: auto;
    font-size: 14px;
    color: #ccc;
  }
</style>
</head>
<body>

  <div class="logo">
    <img src="logo.jpg" alt="Logo">
  </div>
  <div class="banner">SUN WIN</div>

  <div class="card" id="authCard">
    <h3>Đăng ký / Đăng nhập</h3>
    <div style="display:flex;flex-direction:column;gap:8px">
      <input id="username" placeholder="Tên đăng nhập">
      <input id="password" placeholder="Mật khẩu" type="password">
      <div style="display:flex;justify-content:flex-end;gap:8px">
        <button onclick="register()">Đăng ký</button>
        <button onclick="login()">Đăng nhập</button>
      </div>
      <div style="font-size:13px;color:#eee">Lần đầu đăng ký được tặng <strong>100,000,000</strong></div>
    </div>
  </div>

  <div class="card" id="gameCard" style="display:none">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
      <div>Xin chào <strong id="currentUser"></strong></div>
      <div>Số dư: <strong id="balance"></strong> đ</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:center;align-items:center">
      <select id="betChoice">
        <option value="Tài">Tài</option>
        <option value="Xỉu">Xỉu</option>
      </select>
      <input id="betAmount" type="number" placeholder="Số tiền cược">
      <button onclick="play()" id="playBtn">Lắc xúc xắc</button>
      <button onclick="logout()" style="background:#777;color:#fff">Đăng xuất</button>
    </div>

    <div class="plate">
      <div class="cover" id="cover"></div>
      <div class="dice-area" id="diceArea">
        <div class="dice" id="dice1">?</div>
        <div class="dice" id="dice2">?</div>
        <div class="dice" id="dice3">?</div>
      </div>
    </div>

    <div id="result">Chọn Tài / Xỉu và đặt cược rồi nhấn Lắc.</div>
  </div>

  <div class="footer">by: Đạt Gold</div>

  <audio id="soundShake" src="shake.mp3" preload="auto"></audio>
  <audio id="soundWin" src="win.mp3" preload="auto"></audio>
  <audio id="soundLose" src="lose.mp3" preload="auto"></audio>

<script>
let users = JSON.parse(localStorage.getItem('users') || "{}");
let currentUser = null;
let canPlay = true;

// tự login nếu đã lưu
if(localStorage.getItem('currentUser')){
  const saved = localStorage.getItem('currentUser');
  if(users[saved]){
    currentUser = saved;
    showGame();
  }
}

function register(){
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!u || !p){ alert("Nhập tên & mật khẩu!"); return; }
  if(users[u]){ alert("Đã tồn tại tài khoản."); return; }
  users[u] = { password: p, balance: 100000000 };
  localStorage.setItem('users', JSON.stringify(users));
  currentUser = u;
  localStorage.setItem('currentUser', u);
  showGame();
  alert("Đăng ký thành công! Bạn có 100,000,000 đ");
}

function login(){
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!users[u] || users[u].password !== p){
    alert("Sai tên hoặc mật khẩu!");
    return;
  }
  currentUser = u;
  localStorage.setItem('currentUser', u);
  showGame();
}

function logout(){
  currentUser = null;
  localStorage.removeItem('currentUser');
  document.getElementById('gameCard').style.display = 'none';
  document.getElementById('authCard').style.display = 'block';
}

function showGame(){
  document.getElementById('authCard').style.display = 'none';
  document.getElementById('gameCard').style.display = 'block';
  document.getElementById('currentUser').textContent = currentUser;
  updateBalance();
}

function updateBalance(){
  if(currentUser){
    document.getElementById('balance').textContent = users[currentUser].balance.toLocaleString();
  }
}

function play(){
  if(!currentUser){ alert("Bạn chưa đăng nhập!"); return; }
  if(!canPlay){ alert("Chờ cooldown!"); return; }

  const betChoice = document.getElementById('betChoice').value;
  const betAmount = parseInt(document.getElementById('betAmount').value);
  if(!betAmount || betAmount <= 0){ alert("Nhập số tiền cược hợp lệ!"); return; }
  if(betAmount > users[currentUser].balance){ alert("Số dư không đủ!"); return; }

  canPlay = false;
  const btn = document.getElementById('playBtn');
  btn.disabled = true;

  const cover = document.getElementById('cover');
  cover.classList.remove('open');
  const diceEls = [
    document.getElementById('dice1'),
    document.getElementById('dice2'),
    document.getElementById('dice3')
  ];
  diceEls.forEach(d => { d.classList.add('shake'); d.textContent = '?' });

  document.getElementById('result').textContent = "Đang lắc...";
  // play shake
  try {
    const s = document.getElementById('soundShake');
    s.currentTime = 0;
    s.play();
  } catch(e){ }

  setTimeout(() => {
    const d1 = Math.floor(Math.random()*6)+1;
    const d2 = Math.floor(Math.random()*6)+1;
    const d3 = Math.floor(Math.random()*6)+1;

    diceEls[0].textContent = d1;
    diceEls[1].textContent = d2;
    diceEls[2].textContent = d3;
    diceEls.forEach(d => d.classList.remove('shake'));

    const total = d1 + d2 + d3;
    let outcome = "";
    if(total >= 4 && total <= 10) outcome = "Xỉu";
    else if(total >= 11 && total <= 17) outcome = "Tài";
    else outcome = "Bộ Ba";

    let resultText = `Tổng: ${total} — ${outcome}`;

    if(outcome === betChoice){
      users[currentUser].balance += betAmount;
      resultText += ` ✅ Bạn thắng! +${betAmount.toLocaleString()}`;
      try {
        const sw = document.getElementById('soundWin');
        sw.currentTime = 0;
        sw.play();
      } catch(e){}
    } else {
      users[currentUser].balance -= betAmount;
      resultText += ` ❌ Bạn thua! -${betAmount.toLocaleString()}`;
      try {
        const sl = document.getElementById('soundLose');
        sl.currentTime = 0;
        sl.play();
      } catch(e){}
    }

    localStorage.setItem('users', JSON.stringify(users));
    updateBalance();
    document.getElementById('result').textContent = resultText;

    cover.classList.add('open');

    let countdown = 30;
    const interval = setInterval(() => {
      document.getElementById('result').textContent = resultText + ` | Đợi ${countdown}s để chơi lại`;
      countdown--;
      if(countdown < 0){
        clearInterval(interval);
        btn.disabled = false;
        canPlay = true;
        document.getElementById('result').textContent = "Bạn có thể chơi tiếp!";
      }
    }, 1000);

  }, 1500);
}
</script>

</body>
</html>